<?xml version="1.0" encoding="UTF-8"?>
<specialpage><name>Factory</name><title><![CDATA[keramoFactory]]></title><parent/><tags><![CDATA[]]></tags><slug/><template><![CDATA[template.php]]></template><menu/><headercomponent>&lt;link rel="stylesheet" type="text/css" href="&lt;?php get_theme_url(); ?&gt;/css/gallery.css"&gt;&#13;
 &lt;script src="http://code.jquery.com/jquery-latest.min.js"&gt;&lt;/script&gt;&#13;
&#13;
</headercomponent><showcomponent><![CDATA[<p><?php get_custom_field('headtext'); ?></p>

<?php 
    $collections = array();
    $collection = array(
        'name' => "",
        'dir' => "",
        'img' => "",
        'link' => "",
        'color' => ""
    );

    $field = return_custom_field('collections');
    $buf = "";
    $counter = 1;

    for ($i = 0; $i < strlen($field); $i++){
        if (ord($field[$i]) == 10){
            switch ($counter) {
                case 1:
                    $collection['name'] = $buf;
                    break;
                case 2:
                    $collection['dir'] = $buf;
                    break;
                case 3:
                    $collection['img'] = $buf;
                    break;
                case 4:
                    $collection['link'] = $buf;
                    break;
                case 5:
                    $collection['color'] = $buf;
                    break;
            }
            $buf = "";
            $counter++;
            if ($counter > 5) {
                $counter = 1;
                $collections[count($collections)] = $collection;
            }
        }else{
            $buf = $buf . $field[$i];
        }
    }
    $collection['color'] = $buf;
    if (!$collection['name'] == "") {
        $collections[count($collections)] = $collection;
    }
    ?>
<div id="gallery">

<?php
$innerHTML = "";
    foreach ($collections as $collection) {
        
        $innerHTML = $innerHTML . "<div class=\"element\" color=\"" . $collection['color'] . "\">";
        $innerHTML = $innerHTML . "<a href=\"" . get_site_url(false) . "index.php?id=" . $collection['link'] . "\">";
        $innerHTML = $innerHTML . "<img src=\"" . get_site_url(false) . "data/uploads/collection/" . $collection['dir'] . "/" . $collection['img'] . "\" alt=\"" . $collection['name'] . "\">";
        $innerHTML = $innerHTML . "<span>" . $collection['name'] . "</span>";
        $innerHTML = $innerHTML . "</a>";
        $innerHTML = $innerHTML . "</div>";

    }
    echo "$innerHTML";
?>

</div>

  <script src="<?php get_theme_url(); ?>/js/gallery.js"></script><?php get_page_content(); ?>

]]></showcomponent><defaultcontent><![CDATA[]]></defaultcontent><fields><item><name><![CDATA[collections]]></name><label><![CDATA[collections]]></label><type><![CDATA[textarea]]></type></item><item><name><![CDATA[headtext]]></name><label><![CDATA[headtext]]></label><type><![CDATA[textarea]]></type></item></fields></specialpage>
