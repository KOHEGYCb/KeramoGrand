<?xml version="1.0" encoding="UTF-8"?>
<specialpage><name>usage</name><title><![CDATA[usage]]></title><parent/><tags><![CDATA[]]></tags><slug/><template><![CDATA[template.php]]></template><menu/><headercomponent>&lt;link rel="stylesheet" type="text/css" href="&lt;?php get_theme_url(); ?&gt;/css/usage.css" media="all" /&gt;&#13;
&lt;link rel="stylesheet" type="text/css" href="&lt;?php get_theme_url(); ?&gt;/css/jquery.fancybox.css" /&gt;</headercomponent><showcomponent><![CDATA[<?php 

$field = return_custom_field('usage');

$elementPattern = "
        <a class='<USAGE>' data-fancybox='gallery' href='".get_site_url(false)."data/uploads/usage/$field/<IMG_URL>' data-caption='<DESCRIPTION>'>
            <img src='".get_site_url(false)."data/uploads/usage/$field/small/<IMG_URL>'>
        </a>
        ";

$xmlDoc = simplexml_load_file("./xml/usage.xml");

$items = $xmlDoc->xpath('//'.$field.'/item');
$list = "";
$arr_use = array();
foreach ($items as $item) {
    // $html = str_replace("<NAME>", $item->name, $elementPattern);
    $html = str_replace("<DESCRIPTION>", $item->description, $elementPattern);
    $html = str_replace("<IMG_URL>", $item->imageUrl, $html);
    // $html = str_replace("<IMG_URL_SMALL>", get_site_url(false)."data/uploads/usage/furniture/small/".$item->imageUrl, $html);
    // $html = str_replace("<URL>", get_theme_url(false), $html);

    $usages = $item->xpath('usages/use');
    $usage = "";
    foreach ($usages as $use) {
        $usage = $usage.' '.$use;
        array_push($arr_use, $use);
    }
    $html = str_replace("<USAGE>", $usage, $html);
    $list = $list.$html;  
}
$arr_use = array_unique($arr_use);
?>
<section>
        <span>Фильтр: </span><select id="usage" class="usage_select">
            <option value="">Все</option>
        <?php 
            foreach ($arr_use as $key) {
            echo "<option value='$key'>".str_replace("_", " ", $key)."</option>";
        }
        ?>
        </select>

<p class="gallery_list">
    <?php echo $list;?>
</p>

    

</section>

<!-- for fancybox -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="<?php get_theme_url(); ?>/js/jquery.fancybox.js"></script>
<script src="<?php get_theme_url(); ?>/js/usage.js"></script>]]></showcomponent><showcomponent_en><![CDATA[<?php 

$field = return_custom_field('usage');

$elementPattern = "
        <a class='<USAGE>' data-fancybox='gallery' href='".get_site_url(false)."data/uploads/usage/$field/<IMG_URL>' data-caption='<DESCRIPTION>'>
            <img src='".get_site_url(false)."data/uploads/usage/$field/small/<IMG_URL>'>
        </a>
        ";

$xmlDoc = simplexml_load_file("./xml/usage.xml");

$items = $xmlDoc->xpath('//'.$field.'/item');
$list = "";
$arr_use = array();
foreach ($items as $item) {
    // $html = str_replace("<NAME>", $item->name, $elementPattern);
    $html = str_replace("<DESCRIPTION>", $item->description, $elementPattern);
    $html = str_replace("<IMG_URL>", $item->imageUrl, $html);
    // $html = str_replace("<IMG_URL_SMALL>", get_site_url(false)."data/uploads/usage/furniture/small/".$item->imageUrl, $html);
    // $html = str_replace("<URL>", get_theme_url(false), $html);

    $usages = $item->xpath('usages/use');
    $usage = "";
    foreach ($usages as $use) {
        $usage = $usage.' '.$use;
        array_push($arr_use, $use);
    }
    $html = str_replace("<USAGE>", $usage, $html);
    $list = $list.$html;  
}
$arr_use = array_unique($arr_use);
?>
<section>
        <span>Filter: </span><select id="usage" class="usage_select">
            <option value="">all</option>
        <?php 
            foreach ($arr_use as $key) {
            echo "<option value='$key'>".str_replace("_", " ", $key)."</option>";
        }
        ?>
        </select>

<p class="gallery_list">
    <?php echo $list;?>
</p>

    

</section>

<!-- for fancybox -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="<?php get_theme_url(); ?>/js/jquery.fancybox.js"></script>
<script src="<?php get_theme_url(); ?>/js/usage.js"></script>]]></showcomponent_en><defaultcontent><![CDATA[]]></defaultcontent><fields><item><name><![CDATA[usage]]></name><label><![CDATA[usage]]></label><type><![CDATA[text]]></type></item></fields></specialpage>
